var subwayMap = document.getElementsByClassName("subwayMap")[0];
var svg = document.getElementById("subwayMap").children[0];
var xMagnification = svg.clientWidth / 2234;
var yMagnification = svg.clientHeight / 1658;
var colliderList = document.querySelectorAll(".station");
var stationList = [];
for(var i = 0; i < colliderList.length;i++){
    var spanList = colliderList[i].children[colliderList[i].children.length-1].children;
    var station = "";
    for(var j = 0; j < spanList.length;j++){
        station += spanList[j].innerHTML;
    }
    var myData = {
        station: station,
        prop: colliderList[i]
    };
    colliderList[i].myData = myData;
    stationList.push(myData);
    colliderList[i].addEventListener("click", function (e) {
        Android.onClickStation(this.myData.station);
    });
}
function setMarkers(markerList) {
    markerList.forEach(function (station) {
        var idx = -1
        for(var i = 0; i < stationList.length;i++){
            var x = stationList[i]
            if (x.station.indexOf(station.station) != -1){
                idx = i
                break;
            }
        }
        if (idx != -1) {
            var x = stationList[idx].prop;
            var transformData = x.transform.baseVal[0].matrix;
            var transformX = transformData.e * xMagnification - 8;
            var transformY = transformData.f * yMagnification - 22;
            var parser = new DOMParser();
            var wrapper = parser.parseFromString("\n                <svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"100\"\n                    height=\"148\" viewBox=\"0 0 100 148\">\n                    <defs>\n                        <clipPath id=\"clip-Artboard_1\">\n                            <rect width=\"100\" height=\"148\" />\n                        </clipPath>\n                    </defs>\n                    <g id=\"Artboard_1\" data-name=\"Artboard â€“ 1\" clip-path=\"url(#clip-Artboard_1)\">\n                        <rect width=\"100\" height=\"148\" fill=\"rgba(255,255,255,0)\" />\n                        <g class=\"marker_color\" data-name=\"Union 1\" transform=\"translate(867 -7)\" fill=\"" + station.color + "\" style=\"stroke:#000;stroke-width:10;\">\n                            <path\n                                d=\"M -817.1012573242188 149.2977752685547 L -856.1766357421875 70.65471649169922 L -856.06787109375 70.65471649169922 L -856.3502807617188 69.96520233154297 C -858.4401245117188 64.86286163330078 -859.499755859375 59.45774841308594 -859.499755859375 53.9000244140625 C -859.499755859375 48.17615127563477 -858.378662109375 42.62360382080078 -856.167724609375 37.39664077758789 C -854.0321044921875 32.3477668762207 -850.9747314453125 27.81324005126953 -847.0805053710938 23.91900444030762 C -843.1863403320313 20.0247859954834 -838.6517944335938 16.96740531921387 -833.6029663085938 14.83178615570068 C -828.3760986328125 12.62084102630615 -822.8236083984375 11.49980449676514 -817.099853515625 11.49980449676514 C -811.3749389648438 11.49980449676514 -805.8218383789063 12.62084102630615 -800.5947875976563 14.83178615570068 C -795.5458984375 16.96735000610352 -791.0115966796875 20.02473258972168 -787.1177368164063 23.91898536682129 C -783.2240600585938 27.81307792663574 -780.1671142578125 32.34760284423828 -778.0319213867188 37.39660263061523 C -775.8214721679688 42.6234245300293 -774.70068359375 48.17596817016602 -774.70068359375 53.9000244140625 C -774.70068359375 61.7261848449707 -776.8491821289063 69.37184143066406 -780.9139404296875 76.01045989990234 L -780.9258422851563 76.02982330322266 L -780.9358520507813 76.05018615722656 L -817.1012573242188 149.2977752685547 Z\"\n                                stroke=\"#000\" />\n                            <path\n                                d=\"M -817.099853515625 11.99980163574219 C -822.75634765625 11.99980163574219 -828.2432861328125 13.1075439453125 -833.408203125 15.29229736328125 C -838.3974609375 17.40269470214844 -842.8785400390625 20.42410278320313 -846.7269897460938 24.27256774902344 C -850.575439453125 28.12104797363281 -853.5968627929688 32.60214233398438 -855.707275390625 37.59142303466797 C -857.8920288085938 42.75643920898438 -858.999755859375 48.24343872070313 -858.999755859375 53.9000244140625 C -858.999755859375 59.3924560546875 -857.9526977539063 64.73380279541016 -855.8875732421875 69.77569580078125 L -855.32275390625 71.15471649169922 L -855.369873046875 71.15471649169922 L -817.1026611328125 148.1712799072266 L -781.3842163085938 75.82881927490234 L -781.3640747070313 75.78809356689453 L -781.3403930664063 75.74936676025391 C -777.3237915039063 69.18940734863281 -775.20068359375 61.63402557373047 -775.20068359375 53.9000244140625 C -775.20068359375 48.24324035644531 -776.3081665039063 42.7562255859375 -778.492431640625 37.59134674072266 C -780.6024169921875 32.60197448730469 -783.6234130859375 28.12086486816406 -787.4713134765625 24.27253723144531 C -791.3193969726563 20.42402648925781 -795.80029296875 17.40263366699219 -800.78955078125 15.29229736328125 C -805.9546508789063 13.1075439453125 -811.4422607421875 11.99980163574219 -817.099853515625 11.99980163574219 M -817.099853515625 10.99980163574219 C -793.403564453125 10.99980163574219 -774.20068359375 30.20814514160156 -774.20068359375 53.9000244140625 C -774.20068359375 62.09760284423828 -776.4990234375 69.75746154785156 -780.487548828125 76.27155303955078 L -817.099853515625 150.42431640625 L -856.9833984375 70.15471649169922 L -856.81298828125 70.15471649169922 C -858.8662109375 65.14174652099609 -859.999755859375 59.65235137939453 -859.999755859375 53.9000244140625 C -859.999755859375 30.20814514160156 -840.791259765625 10.99980163574219 -817.099853515625 10.99980163574219 Z\"\n                                stroke=\"#000\" fill=\"#fff\" />\n                        </g>\n                    </g>\n                </svg>\n                ", "text/html");
            var img = wrapper.body.children[0];
            img.classList.add("marker");
            img.style.transform = "translate(" + transformX + "px," + transformY + "px)";
            document.getElementsByClassName("subway_container")[0].appendChild(img);
        }
    });
}
function clearMarkers() {
    var markers = document.querySelectorAll(".marker");
    markers.forEach(function (x) {
        x.parentNode.removeChild(x);
    });
}